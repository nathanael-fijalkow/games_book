\documentclass[preview,border=0mm,convert={density=600,outext=.png}]{standalone}
\usepackage{amsfonts,amssymb,amsmath}
\usepackage{tikz}
\usetikzlibrary{automata,shapes,patterns,calc,arrows}
\input{../tikz-style.tex}
\input{../norenew_macros.tex}
\input{./../9_Timed/norenew_macros_local.tex}
\begin{document}
\begin{tikzpicture}
    \draw (0,1) node[state] (a) {$\ell_0$};
    \draw (0,-1) node[state] (b) {$\ell_1$};
    \draw (3,0) node[state,double] (W) {$W$};
    \draw[arrow] (a) -- (W) node[midway,above right] {$\genfrac{}{}{0pt}{0}{1\leq x_1\leq 4}{{}\wedge x_2=3}$};
    \draw (a) edge[arrow,dashed] (b) node[midway,left] {$\genfrac{}{}{0pt}{0}{1\leq x_1\leq 2}{{}\wedge x_2\leq 2}$};
    \draw[initial] (a.135) -- +(135:3mm);
    
    
    \begin{scope}[xshift=5cm,yshift=-1cm,scale=.55]
      \draw[latex'-latex'] (4.5,0) node[right] {$x_1$}
      -| (0,4.5) node[left] {$x_2$};
      \begin{scope}
        \path[clip] (0,0) -- (4.5,0) [rounded corners=10mm]
          -- (4.5,4.5) [rounded corners=0mm] -| (0,0);
        \fill[opacity=.6,dgrey,hatcharea] (1,0) -| (2,2) -| cycle;
        
        \fill[dgrey,fillarea] (0,1) -- (1,2) -| (2,1) -- (4,3) -- (1,3) -- (0,2) -- cycle;
        \draw[line width=3.2pt,dgrey] (1,3) -- (4,3);
        \begin{scope}[opacity=.3]
        \foreach \x in {-4,...,4}
                 {\draw (\x,0) -- +(9,9);
                   \draw (0,\x) -- +(9,0);
                   \draw (\x,0) -- +(0,9);}
        \end{scope}
      \end{scope}


      \path (3.5,4) node {$X$} edge[-latex',bend right=12] (2.8,3.2);
      \path (3.5,0.5) node {$Y$} edge[-latex',bend left=12] (2.2,0.6);
      \path (4.5,1.5) node {$\pi(W)$} edge[-latex',bend left=12] (2.6,1.8);
    \end{scope}
  \end{tikzpicture}
\end{document}