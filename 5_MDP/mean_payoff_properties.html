
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mean-payoff in MDPs: General properties and linear programming &#8212; Games on graphs</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Mean-payoff optimality in strongly connected MDPs" href="mean_payoff_strongly_connected.html" />
    <link rel="prev" title="Discounted payoff in MDPs" href="discounted.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/cover.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Games on graphs</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../1_Introduction/index.html">
   Introduction
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../1_Introduction/intro.html">
     What is this book about?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_Introduction/simple.html">
     A first model of games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_Introduction/objectives.html">
     Objectives
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_Introduction/computation.html">
     Computational models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_Introduction/automata.html">
     Automata
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_Introduction/memory.html">
     Memory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_Introduction/reductions.html">
     Reductions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_Introduction/subgames.html">
     Traps and subgames
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_Introduction/fixed_points.html">
     Generic fixed point algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_Introduction/value_iteration.html">
     Value iteration algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_Introduction/strategy_improvement.html">
     Strategy improvement algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_Introduction/references.html">
     Bibliographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Classic
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../2_Regular/index.html">
   Regular Games
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../2_Regular/attractors.html">
     Reachability games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_Regular/buchi.html">
     BÃ¼chi games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_Regular/parity.html">
     Parity games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_Regular/muller.html">
     Rabin, Streett, and Muller games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_Regular/zielonka.html">
     Zielonka tree
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_Regular/references.html">
     Bibliographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../3_Parity/index.html">
   Parity Games
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../3_Parity/strategy_improvement.html">
     An exponential time strategy improvement algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_Parity/zielonka.html">
     A quasipolynomial time attractor decomposition algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_Parity/separation.html">
     A quasipolynomial time separating automata algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_Parity/value_iteration.html">
     A quasipolynomial time value iteration algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_Parity/relationships.html">
     Comparing the three families of algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_Parity/references.html">
     Bibliographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../4_Payoffs/index.html">
   Games with Payoffs
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../4_Payoffs/notations.html">
     Notations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_Payoffs/qualitative.html">
     Refining qualitative objectives with quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_Payoffs/mean_payoff.html">
     Mean payoff games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_Payoffs/discounted_payoff.html">
     Discounted payoff games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_Payoffs/shortest_path.html">
     Shortest path games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_Payoffs/total_payoff.html">
     Total payoff games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_Payoffs/references.html">
     Bibliographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Stochastic
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="index.html">
   Markov Decision Processes
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="notations.html">
     Notations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="reachability.html">
     Positive and almost-sure reachability and safety in MDPs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="discounted.html">
     Discounted payoff in MDPs
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Mean-payoff in MDPs: General properties and linear programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mean_payoff_strongly_connected.html">
     Mean-payoff optimality in strongly connected MDPs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="end_components.html">
     End components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="reductions.html">
     Reductions to optimal reachability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="optimal_reachability.html">
     Optimal reachability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="references.html">
     Bibliographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../6_Stochastic/index.html">
   Stochastic Games
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../6_Stochastic/notations.html">
     Notations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_Stochastic/determinacy.html">
     Positional determinacy of stochastic reachability games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_Stochastic/relations.html">
     Relations between all games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_Stochastic/algos.html">
     Algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_Stochastic/references.html">
     Bibliographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Information
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../7_Concurrent/index.html">
   Concurrent Games
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Concurrent/notations.html">
     Notations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Concurrent/matrix_games.html">
     Matrix games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Concurrent/discounted.html">
     Concurrent discounted games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Concurrent/reachability.html">
     Concurrent reachability games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Concurrent/mean_payoff.html">
     Concurrent mean-payoff games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Concurrent/discounted.html">
     Concurrent discounted games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Concurrent/references.html">
     Bibilographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../8_Imperfect/index.html">
   Games with Signals
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../8_Imperfect/notations.html">
     Notations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../8_Imperfect/finite_duration.html">
     Finite duration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../8_Imperfect/infinite_duration.html">
     Infinite duration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../8_Imperfect/references.html">
     Bibliographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Infinite
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../9_Timed/index.html">
   Timed Games
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../9_Timed/notations.html">
     Notations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../9_Timed/state_space_representation.html">
     State-Space Representation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../9_Timed/controllable_predecessor_operator.html">
     Controllable-Predecessor Operator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../9_Timed/backward_algorithm.html">
     Backward Algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../9_Timed/forward_algorithm.html">
     Forward Algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../9_Timed/references.html">
     Bibliographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../10_Pushdown/index.html">
   Pushdown Games
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../10_Pushdown/notations.html">
     Notations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10_Pushdown/profiles.html">
     Profiles and regularity of the winning regions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10_Pushdown/parity.html">
     Parity pushdown games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10_Pushdown/references.html">
     Bibliographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../11_Counters/index.html">
   Games with Counters
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../11_Counters/counters.html">
     Vector games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11_Counters/dim1.html">
     Games in dimension one
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11_Counters/avag.html">
     Asymmetric games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11_Counters/resource.html">
     Resource-conscious games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11_Counters/complexity.html">
     The complexity of asymmetric monotone games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11_Counters/references.html">
     Bibliographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Multi
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../12_Multiobjectives/index.html">
   Games with multiple objectives
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../12_Multiobjectives/mean_payoff_energy.html">
     Mean-payoff and energy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_Multiobjectives/total_payoff_shortest_path.html">
     Total-payoff and shortest path
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_Multiobjectives/beyond_worst_case.html">
     Beyond worst-case synthesis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_Multiobjectives/percentile.html">
     Percentile queries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_Multiobjectives/references.html">
     Bibliographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../13_Multiplayer/index.html">
   Multiplayer Games
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../13_Multiplayer/nash_equilibria_normal_form.html">
     Nash Equilibria for games in normal form
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13_Multiplayer/admissible_strategies.html">
     Admissible strategies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13_Multiplayer/references.html">
     Bibliographic references
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="mean-payoff-in-mdps-general-properties-and-linear-programming">
<span id="sec-mean-payoff-properties"></span><h1>Mean-payoff in MDPs: General properties and linear programming<a class="headerlink" href="#mean-payoff-in-mdps-general-properties-and-linear-programming" title="Permalink to this headline">Â¶</a></h1>
<p>We will use the <span class="math notranslate nohighlight">\(\liminf\)</span> variant of mean-payoff:</p>
<div class="math notranslate nohighlight">
\[
  \mathtt{MeanPayoff}^{\;-}( \pi) = \liminf_n \frac{1}{n} \sum_{i = 0}^{n-1} c( \pi_i)
\]</div>
<p>In particular, the play-based expected mean-payoff achieved by <span class="math notranslate nohighlight">\( \sigma \)</span> from <span class="math notranslate nohighlight">\( v \)</span> is <span class="math notranslate nohighlight">\(  \textsf{p-Payoff}(v, \sigma) =  \mathbb{E}_v^\sigma[  \mathtt{MeanPayoff}^{\;-}] \)</span>, while for the step-based counterpart we have <span class="math notranslate nohighlight">\(  \textsf{s-Payoff}(v, \sigma) = \liminf_{n \rightarrow \infty} \frac{1}{n} \sum_{i=0}^{n-1}  \mathbb{E}_v^\sigma[ c( \pi_i)]\)</span>.</p>
<p>The use of <span class="math notranslate nohighlight">\( \liminf \)</span> is natural in the formal verification setting: taking the <span class="math notranslate nohighlight">\(\liminf\)</span> rather than <span class="math notranslate nohighlight">\( \limsup \)</span> emphasizes the worst-case behaviour along a play. However, all the results in this section hold also for <span class="math notranslate nohighlight">\(\limsup\)</span>-based mean-payoff, though some proofs are more complex. See the bibliographic remarks for more details.</p>
<p>In general, <span class="math notranslate nohighlight">\(\textsf{s-Payoff}(v,\sigma)\)</span> can be different from <span class="math notranslate nohighlight">\(  \textsf{p-Payoff}(v, \sigma) \)</span>. However, we have the following simple consequence of the dominated convergence theorem:</p>
<div class="proof lemma admonition" id="5-lem:limit-defined">
<p class="admonition-title"><span class="caption-number">Lemma 167 </span> (NEEDS TITLE 5-lem:limit-defined)</p>
<div class="lemma-content section" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(U\)</span> be the set of all plays <span class="math notranslate nohighlight">\(\pi\)</span>  for which <span class="math notranslate nohighlight">\(\lim_{n\rightarrow \infty} \frac{1}{n} \sum_{i=0}^{n-1}[ c( \pi_i)]\)</span> is undefined. If <span class="math notranslate nohighlight">\(v_0,\sigma\)</span> are such that <span class="math notranslate nohighlight">\(\mathbb{P}^\sigma_{ v_0}(U) = 0\)</span>, then <span class="math notranslate nohighlight">\(\textsf{s-Payoff}( v_0,\sigma) =  \textsf{p-Payoff}( v_0, \sigma) \)</span>.</p>
</div>
</div><p>In particular, for any finite-memory strategy <span class="math notranslate nohighlight">\( \sigma \)</span>, the two values coincide, since applying such a strategy turns an MDP into a finite Markov chain where the existence of the limit can be inferred using decomposition into strongly connected components and applying the Ergodic theorem.
We will show that in our case of finite-state MDPs, the two approaches coincide not only at the levels of finite-memory strategies, but also as optimality criteria: that is, no matter which of the two semantics we use, the optimal values are the same and a strategy that is optimal w.r.t. one of the semantics is also optimal for the other one. We caution the reader that such a result does not automatically transfer to more complex settings, such as infinite-state MDPs or multi-objective optimization.</p>
<p>To simplify the subsequent notation, we define the <strong>expected one-step</strong> reward of a vertex-action pair <span class="math notranslate nohighlight">\((v,a)\)</span> to be the number <span class="math notranslate nohighlight">\(\sum_{w\in  V}  \Delta(w\mid v,a)\cdot  c(v,w)\)</span>. Overloading the notation, we denote this quantity by <span class="math notranslate nohighlight">\(c(v,a)\)</span>.</p>
<p>In mean-payoff  MDPs, a crucial role is played by the linear program <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}\)</span> pictured in <a class="reference internal" href="#fig-mp-lin"><span class="std std-numref">Fig. 49</span></a>.</p>
<p>HOW DO WE DEAL WITH EQUATION LABELS IN FIGURES?</p>
<div class="figure align-center" id="fig-mp-lin">
<img alt="../_images/5-fig:mp-lin.png" src="../_images/5-fig:mp-lin.png" />
<p class="caption"><span class="caption-number">Fig. 49 </span><span class="caption-text">The linear program <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}\)</span> with variables <span class="math notranslate nohighlight">\(x_{(v,a)}\)</span> for  <span class="math notranslate nohighlight">\(v\in  V,a\in  A\)</span>.</span><a class="headerlink" href="#fig-mp-lin" title="Permalink to this image">Â¶</a></p>
</div>
<p>There is a correspondence between feasible solutions of <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}\)</span> and the strategies in the corresponding MDP. Intuitively, in a solution corresponding to a strategy <span class="math notranslate nohighlight">\(\sigma\)</span>, the value of a variable <span class="math notranslate nohighlight">\(x_{v,a}\)</span> describes the expected frequency with which <span class="math notranslate nohighlight">\(\sigma\)</span> visits <span class="math notranslate nohighlight">\(v\)</span> and plays <span class="math notranslate nohighlight">\(a\)</span> upon such a visit. These frequencies must obey the <strong>flow constraints</strong> <code class="xref eq docutils literal notranslate"><span class="pre">5-eq:mdp-flow</span></code> and must represent a probability distribution, which is ensured by <code class="xref eq docutils literal notranslate"><span class="pre">5-eq:mdp-freq-1</span></code> and <code class="xref eq docutils literal notranslate"><span class="pre">5-eq:mdp-freq-nonnegp</span></code>. The objective function then represents the expected mean payoff. Of high importance is also the linear program which is <strong>dual</strong> to <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}\)</span>. This dual program, denoted <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}^{\mathit{dual}}\)</span>, is pictured in <a class="reference internal" href="#fig-mp-dual"><span class="std std-numref">Fig. 50</span></a>. (For a refresher on linear programming and duality, see, e.g. <span id="id1">[<a class="reference internal" href="references.html#id120"><span>Matouvsek07</span></a>]</span>).</p>
<div class="figure align-center" id="fig-mp-dual">
<img alt="../_images/5-fig:mp-dual.png" src="../_images/5-fig:mp-dual.png" />
<p class="caption"><span class="caption-number">Fig. 50 </span><span class="caption-text">The linear program <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}^{\mathit{dual}}\)</span> with variables <span class="math notranslate nohighlight">\(g\)</span> and <span class="math notranslate nohighlight">\(y_v\)</span> for each  <span class="math notranslate nohighlight">\(v\in  V\)</span>.</span><a class="headerlink" href="#fig-mp-dual" title="Permalink to this image">Â¶</a></p>
</div>
<div class="proof remark admonition" id="remark-1">
<p class="admonition-title"><span class="caption-number">Remark 168 </span> (NEEDS LABEL Nomenclature)</p>
<div class="remark-content section" id="proof-content">
<p>A feasible solution of <span class="math notranslate nohighlight">\(   \mathcal{L}_{\mathit{mp}} \)</span> is a vector <span class="math notranslate nohighlight">\(\vec{x} \in  \mathbb{R}^{ V\times  A} \)</span> s.t. setting <span class="math notranslate nohighlight">\( x_{(v,a)}=\vec{x}_{(v,a)} \)</span> for all <span class="math notranslate nohighlight">\( (v,a) \)</span> satisfies the constraints in <span class="math notranslate nohighlight">\(   \mathcal{L}_{\mathit{mp}} \)</span>. A feasible solution of <span class="math notranslate nohighlight">\(    \mathcal{L}_{\mathit{mp}}^{\mathit{dual}}  \)</span> is a tuple <span class="math notranslate nohighlight">\( (g,\vec{y}) \)</span>, where <span class="math notranslate nohighlight">\( g\in \mathbb{R} \)</span> (using the same notation for the number and the variable should not cause  confusion here) and <span class="math notranslate nohighlight">\( \vec{y}\in  \mathbb{R}^{ V}\)</span> s.t. setting the corresponding variables to numbers prescribed by <span class="math notranslate nohighlight">\( g \)</span> and <span class="math notranslate nohighlight">\( \vec{y} \)</span> satisfies the constraints.</p>
</div>
</div><p>The variable <span class="math notranslate nohighlight">\(g\)</span> in <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}^{\mathit{dual}}\)</span> is often called <strong>gain</strong> while the vector of <span class="math notranslate nohighlight">\(y\)</span>-variables is called <strong>bias.</strong> This is because it provides information on how much does the payoff (under some strategy) accumulated up to a certain step deviate from the estimate provided by the mean-payoff value of that strategy. This is illustrated in the following lemma, which forms the first step of our analysis.</p>
<div class="proof lemma admonition" id="5-lem:dual-bound-step">
<p class="admonition-title"><span class="caption-number">Lemma 169 </span> (NEEDS TITLE 5-lem:dual-bound-step)</p>
<div class="lemma-content section" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(({g}, \vec{y})\)</span> be a feasible solution of <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}^{\mathit{dual}}\)</span> and let <span class="math notranslate nohighlight">\(Y^{(i)}\)</span>, where <span class="math notranslate nohighlight">\(i\geq 0\)</span>, be a random variable such that <span class="math notranslate nohighlight">\(Y^{(i)}( \pi)= \vec{y}_{ \textrm{In}(\pi_i)}.\)</span> Then for each strategy <span class="math notranslate nohighlight">\(\sigma\)</span>, each vertex <span class="math notranslate nohighlight">\(v_0\)</span>, and each <span class="math notranslate nohighlight">\(n\geq 0\)</span> it holds <span class="math notranslate nohighlight">\(\mathbb{E}^\sigma_{ v_0}[\sum_{i=0}^{n-1} c( \pi_i)]\leq n\cdot {g}- \vec{y}_{ v_0} + \mathbb{E}^\sigma_{ v_0} [Y^{(n)}]\)</span>.</p>
</div>
</div><div class="dropdown tip admonition">
<p class="admonition-title">Proof</p>
<p>By induction on <span class="math notranslate nohighlight">\(n\)</span>. For <span class="math notranslate nohighlight">\(n=0\)</span>, both sides are equal to 0. Now assume that the inequality holds for some <span class="math notranslate nohighlight">\(n\geq 0\)</span>. By the induction hypothesis</p>
<div class="math notranslate nohighlight" id="equation-mean-payoff-properties">
<span class="eqno">(9)<a class="headerlink" href="#equation-mean-payoff-properties" title="Permalink to this equation">Â¶</a></span>\[ \mathbb{E}^\sigma_{ v_0}[\sum_{i=0}^{n} c( \pi_i)] &amp;=  \mathbb{E}^\sigma_{ v_0}[\sum_{i=0}^{n-1} c( \pi_i)] +  \mathbb{E}^\sigma_{ v_0}[ c( \pi_n)] \leq n{g}- \vec{y}_{ v_0} + \mathbb{E}^\sigma_{ v_0} [Y^{(n)}] +  \mathbb{E}^\sigma_{ v_0}[ c( \pi_n)] \]</div>
<p>We now obtain a bound for the third term on the RHS of <code class="xref eq docutils literal notranslate"><span class="pre">5-eq:mpdual-1</span></code>. In the following, we denote by <span class="math notranslate nohighlight">\(\Pi_n\)</span> the set of all plays of length <span class="math notranslate nohighlight">\(n\)</span>. Then we have</p>
<div class="math notranslate nohighlight">
\[\begin{split} \mathbb{E}^\sigma_v [Y^{(n)}]&amp;= \sum_{v\in V}  \vec{y}_v\cdot \mathbb{P}^\sigma_{ v_0}( \textrm{In}(\pi_n)=v)
=\sum_{v\in V}  \vec{y}_v\cdot \bigg(\sum_{\substack{ \pi'\in \Pi_n\\  \textrm{last}( \pi')=v}} \mathbb{P}^\sigma_{ v_0}( \pi') \bigg) \\
&amp;=\sum_{v\in V}  \vec{y}_v\cdot \bigg(\sum_{\substack{ \pi'\in \Pi_n\\  \textrm{last}( \pi')=v}} \mathbb{P}^\sigma_{ v_0}( \pi')\cdot\big(\underbrace{\sum_{a\in A}\sigma(a\mid  \pi')}_{=1} \big)\bigg) \\
&amp;= \sum_{\substack{v\in V\\ a \in  A}}  \vec{y}_v\cdot \bigg(\sum_{\substack{ \pi'\in \Pi_n\\  \textrm{last}( \pi')=v}} \mathbb{P}^\sigma_{ v_0}( \pi')\cdot\sigma(a\mid  \pi')\bigg)\\
\text{(by {numref}`5-fig:mp-dual`)}\hspace{3mm}
&amp;{\leq}\sum_{\substack{v\in V\\ a\in  A}} \bigg( {g} - c(v,a) + \sum_{u\in V} \Delta(u\mid v,a)\cdot  \vec{y}_u\bigg)\cdot\bigg(\sum_{\substack{ \pi'\in \Pi_n\\  \textrm{last}( \pi')=v}} \mathbb{P}^\sigma_{ v_0}( \pi')\cdot\sigma(a\mid  \pi')\bigg)\\
&amp;= {g}\cdot\underbrace{\sum_{\substack{v\in V\\ a\in  A}}\sum_{\substack{ \pi'\in \Pi_n\\  \textrm{last}( \pi')=v}} \mathbb{P}^\sigma_{ v_0}( \pi')\cdot\sigma(a\mid  \pi')}_{=1}\\&amp;\quad-\underbrace{\sum_{\substack{v\in V\\ a\in  A}}\sum_{\substack{ \pi'\in \Pi_n\\  \textrm{last}( \pi')=v}} \mathbb{P}^\sigma_{ v_0}( \pi')\cdot\sigma(a\mid  \pi')\cdot c(v,a)}_{= \mathbb{E}^\sigma_{ v_0}[ c( \pi_n)]}\\
&amp;\quad +\underbrace{\sum_{\substack{v,u\in  V\\ a \in  A}}\sum_{\substack{ \pi'\in \Pi_n\\  \textrm{last}( \pi')=v}}  \mathbb{P}^\sigma_{ v_0}( \pi')\cdot\sigma(a\mid  \pi')\cdot  \Delta(u\mid v,a)\cdot  \vec{y}_u}_{= \mathbb{E}^\sigma_{ v_0}[Y^{(n+1)}]}.\end{split}\]</div>
<p>Plugging this into <code class="xref eq docutils literal notranslate"><span class="pre">5-eq:mpdual-1</span></code> yields the desired <span class="math notranslate nohighlight">\(\mathbb{E}^\sigma_{ v_0}[\sum_{i=0}^{n} c( \pi_i)] \leq (n+1) {g}- \vec{y}_{ v_0} +  \mathbb{E}^\sigma_{ v_0}[Y^{(n+1)}]\)</span>.</p>
</div>
<div class="proof corollary admonition" id="5-cor:mp-value-bound">
<p class="admonition-title"><span class="caption-number">Corollary 170 </span> (NEEDS TITLE 5-cor:mp-value-bound)</p>
<div class="corollary-content section" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(g\)</span> be the objective value of some feasible solution of <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}^{\mathit{dual}}\)</span>. Then for every strategy <span class="math notranslate nohighlight">\(\sigma\)</span> and every vertex <span class="math notranslate nohighlight">\(v_0\)</span> it holds <span class="math notranslate nohighlight">\(\textsf{p-Payoff}( v_0,\sigma) \leq  \textsf{s-Payoff}( v_0,\sigma) \leq g\)</span>.</p>
</div>
</div><div class="dropdown tip admonition">
<p class="admonition-title">Proof</p>
<p>Let <span class="math notranslate nohighlight">\( ({g}, \vec{y})\)</span> be any feasible solution of <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}^{\mathit{dual}}\)</span>.
By <a class="reference internal" href="#5-lem:dual-bound-step">Lemma 169</a> we have, for every <span class="math notranslate nohighlight">\(n\geq 0\)</span>, that <span class="math notranslate nohighlight">\(\mathbb{E}^\sigma_{ v_0}[\frac{1}{n}\sum_{i=0}^{n-1} c( \pi_i)]\leq g - \frac{ \vec{y}_{ v_0}}{n}+ \frac{1}{n} \mathbb{E}^\sigma_{ v_0} [Y^{(n)}]\)</span>. Since <span class="math notranslate nohighlight">\( \vec{y}_{ v_0}\)</span> is a constant and <span class="math notranslate nohighlight">\(| \mathbb{E}^\sigma_{ v_0} [Y^{(n)}]|\)</span> is bounded by the constant <span class="math notranslate nohighlight">\( \max_{v\in  V}|\vec{y}_v|\)</span> that is independent of <span class="math notranslate nohighlight">\(n\)</span>, the last two terms on the RHS vanish as <span class="math notranslate nohighlight">\(n\)</span> goes to <span class="math notranslate nohighlight">\(\infty\)</span>. Hence, also <span class="math notranslate nohighlight">\(\textsf{s-Payoff}( v_0,\sigma) = \liminf_{n\rightarrow \infty}  \mathbb{E}^\sigma_{ v_0}[\frac{1}{n}\sum_{i=0}^{n-1} c( \pi_i)] \leq g\)</span>. It remains to show that we have <span class="math notranslate nohighlight">\(\textsf{p-Payoff}( v_0,\sigma) \leq  \textsf{s-Payoff}( v_0,\sigma)\)</span>, but this immediately follows from the Fatouâs lemma (Theorem 1.6.8 in <span id="id2">[<a class="reference internal" href="references.html#id99"><span>ADoleansD00</span></a>]</span>).</p>
</div>
<div class="proof corollary admonition" id="5-cor:lpmp-optimal-exists">
<p class="admonition-title"><span class="caption-number">Corollary 171 </span> (NEEDS TITLE 5-cor:lpmp-optimal-exists)</p>
<div class="corollary-content section" id="proof-content">
<p>Both the linear programs <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}^{\mathit{dual}}\)</span> have a feasible solution. Hence, both have an optimal solution and the optimal values of the objective functions in these programs are equal.</p>
</div>
</div><div class="dropdown tip admonition">
<p class="admonition-title">Proof</p>
<p>One can easily construct a feasible solution for <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}^{\mathit{dual}}\)</span> by setting all the <span class="math notranslate nohighlight">\(y\)</span>-variables to <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(g\)</span> to <span class="math notranslate nohighlight">\(\max_{ c}\)</span>. By the duality theorem for linear programming, to show that also <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}\)</span> has feasible solution it suffices to show that the objective function of <span class="math notranslate nohighlight">\(\mathcal{L}_{\mathit{mp}}^{\mathit{dual}}\)</span> is bounded from below. But this follows from <a class="reference internal" href="#5-cor:mp-value-bound">Corollary 170</a>, since there is at least one strategy <span class="math notranslate nohighlight">\(\sigma\)</span> giving us the lower bound (in particular, the objective function is bounded from below by <span class="math notranslate nohighlight">\(- \max_{ c}\)</span>). The second part follows immediately by linear programming duality.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./5_MDP"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="discounted.html" title="previous page">Discounted payoff in MDPs</a>
    <a class='right-next' id="next-link" href="mean_payoff_strongly_connected.html" title="next page">Mean-payoff optimality in strongly connected MDPs</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By a set of authors<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>